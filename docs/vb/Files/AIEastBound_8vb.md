---
title: C:/Users/rfranks/Documents/Development/EHMR/SignallingSystem/EHMR Signalling System/AI/AIEastBound.vb

---

# C:/Users/rfranks/Documents/Development/EHMR/SignallingSystem/EHMR Signalling System/AI/AIEastBound.vb



## Functions

|                | Name           |
| -------------- | -------------- |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[logic](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-logic)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionA](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectiona)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionB](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionb)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionC](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionc)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionD](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectiond)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionE](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectione)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionF](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionf)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionG](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectiong)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionH](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionh)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionI](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectioni)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionJ](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionj)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionK](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionk)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionL](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionl)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionM](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionm)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionN](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionn)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionO](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectiono)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionP](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionp)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionQ](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionq)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionA11](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectiona11)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionC19](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionc19)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionDE](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionde)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionF12](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionf12)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionF13](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionf13)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionNO](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionno)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionNO14](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionno14)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionOP](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionop)**() |
| [void](/SignallingSystem-doc/vb/Files/SerialPixelLeds_8vb/#variable-void) | **[AISectionQ10](/SignallingSystem-doc/vb/Files/AIEastBound_8vb/#function-aisectionq10)**() |


## Functions Documentation

### function logic

```csharp
void logic()
```


### function AISectionA

```csharp
void AISectionA()
```


### function AISectionB

```csharp
void AISectionB()
```


### function AISectionC

```csharp
void AISectionC()
```


### function AISectionD

```csharp
void AISectionD()
```


### function AISectionE

```csharp
void AISectionE()
```


### function AISectionF

```csharp
void AISectionF()
```


### function AISectionG

```csharp
void AISectionG()
```


### function AISectionH

```csharp
void AISectionH()
```


### function AISectionI

```csharp
void AISectionI()
```


### function AISectionJ

```csharp
void AISectionJ()
```


### function AISectionK

```csharp
void AISectionK()
```


### function AISectionL

```csharp
void AISectionL()
```


### function AISectionM

```csharp
void AISectionM()
```


### function AISectionN

```csharp
void AISectionN()
```


### function AISectionO

```csharp
void AISectionO()
```


### function AISectionP

```csharp
void AISectionP()
```


### function AISectionQ

```csharp
void AISectionQ()
```


### function AISectionA11

```csharp
void AISectionA11()
```


### function AISectionC19

```csharp
void AISectionC19()
```


### function AISectionDE

```csharp
void AISectionDE()
```


### function AISectionF12

```csharp
void AISectionF12()
```


### function AISectionF13

```csharp
void AISectionF13()
```


### function AISectionNO

```csharp
void AISectionNO()
```


### function AISectionNO14

```csharp
void AISectionNO14()
```


### function AISectionOP

```csharp
void AISectionOP()
```


### function AISectionQ10

```csharp
void AISectionQ10()
```




## Source code

```csharp
Module AIEastBound
    Public Sub logic()
        AISectionA()
        AISectionB()
        AISectionC()
        AISectionD()
        AISectionE()
        AISectionF()
        AISectionG()
        AISectionH()
        AISectionI()
        AISectionJ()
        AISectionK()
        AISectionL()
        AISectionM()
        AISectionN()
        AISectionO()
        AISectionP()
        AISectionQ()
        AISectionA11()
        AISectionC19()
        AISectionDE()
        AISectionF12()
        AISectionF13()
        AISectionNO()
        AISectionNO14()
        AISectionOP()
        AISectionQ10()
    End Sub
    Public Sub AISectionA()
        'Start SectionA code as train arrives in section
        If AISectionAOccupie = True And AITimerSectionA = 0 And AISectionAInUse = False Then
            AITimerSectionA = AIShortSectionValue
            AISectionAInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionAInUse = True Then
            If AISectionAOccupie = True And AITimerSectionA <= AIBetweenSections Then
                AISectionBOccupie = True
                AITimerSectionA = AITimerSectionA - 1
                If Not Points.PointReturns(PointNames.P6b) = PointInNormal Then MsgBox("AI Train in section A derailed on point 6b")
            Else
                AITimerSectionA = AITimerSectionA - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionAOccupie = True And AITimerSectionA = 0 And AISectionAInUse = True Then
            AISectionAOccupie = False
            AISectionAInUse = False
        End If
    End Sub
    Public Sub AISectionB()
        'Start SectionB code as train arrives in section
        If AISectionBOccupie = True And AITimerSectionB = 0 And AISectionBInUse = False Then
            AITimerSectionB = AIMediumSectionValue
            AISectionBInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionBInUse = True Then
            If AISectionBOccupie = True And AITimerSectionB <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ16E) = SignalAtDanger Then
                    AISectionCOccupie = True
                    AITimerSectionB = 0
                End If
            Else
                AITimerSectionB = AITimerSectionB - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionBOccupie = True And AITimerSectionB = 0 And AISectionBInUse = True Then
            AISectionBOccupie = False
            AISectionBInUse = False
        End If
    End Sub
    Public Sub AISectionC()
        'Start SectionC code as train arrives in section
        If AISectionCOccupie = True And AITimerSectionC = 0 And AISectionCInUse = False Then
            AITimerSectionC = AILongSectionValue
            AISectionCInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionCInUse = True Then
            If AISectionCOccupie = True And AITimerSectionC <= AIBetweenSections Then
                If Points.PointReturns(PointNames.P19) = PointInNormal Then
                    If Not SignalOutputState(Definitions.SignalNames.AJ8E) = SignalAtDanger Then
                        AISectionDOccupie = True
                        AITimerSectionC = 0
                    End If
                ElseIf Points.PointReturns(PointNames.P19) = PointInReverse Then
                    AISectionC19Occupie = True
                    AITimerSectionC = AITimerSectionC - 1
                Else
                    MsgBox("AI Train in section C derailed on point 19")
                End If
            Else
                AITimerSectionC = AITimerSectionC - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionCOccupie = True And AITimerSectionC = 0 And AISectionCInUse = True Then
            AISectionCOccupie = False
            AISectionCInUse = False
        End If
    End Sub
    Public Sub AISectionD()
        'Start SectionD code as train arrives in section
        If AISectionDOccupie = True And AITimerSectionD = 0 And AISectionDInUse = False Then
            AITimerSectionD = AILongSectionValue
            AISectionDInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionDInUse = True Then
            If AISectionDOccupie = True And AITimerSectionD <= AIBetweenSections Then
                AISectionDEOccupie = True
                AITimerSectionD = AITimerSectionD - 1
            Else
                AITimerSectionD = AITimerSectionD - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionDOccupie = True And AITimerSectionD = 0 And AISectionDInUse = True Then
            AISectionDOccupie = False
            AISectionDInUse = False
        End If
    End Sub
    Public Sub AISectionE()
        'Start SectionE code as train arrives in section
        If AISectionEOccupie = True And AITimerSectionE = 0 And AISectionEInUse = False Then
            AITimerSectionE = AIMediumSectionValue
            AISectionEInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionEInUse = True Then
            If AISectionEOccupie = True And AITimerSectionE <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ4E) = SignalAtDanger Then
                    If Points.PointReturns(PointNames.P13) = PointInNormal Then
                        AISectionFOccupie = True
                        AITimerSectionE = 0
                    ElseIf Points.PointReturns(PointNames.P13) = PointInReverse Then
                        AISectionF13Occupie = True
                        AITimerSectionE = 0
                    Else
                        MsgBox("AI Train in section E derailed on point 13")
                    End If
                End If
            Else
                AITimerSectionE = AITimerSectionE - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionEOccupie = True And AITimerSectionE = 0 And AISectionEInUse = True Then
            AISectionEOccupie = False
            AISectionEInUse = False
        End If
    End Sub
    Public Sub AISectionF()
        'Start SectionF code as train arrives in section
        If AISectionFOccupie = True And AITimerSectionF = 0 And AISectionFInUse = False Then
            AITimerSectionF = AIShortSectionValue
            AISectionFInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionFInUse = True Then
            If AISectionFOccupie = True And AITimerSectionF <= AIBetweenSections Then
                AISectionGOccupie = True
                If Not Points.PointReturns(PointNames.P12) = PointInNormal Then MsgBox("AI Train in section F derailed on point 12")
            End If
            AITimerSectionF = AITimerSectionF - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionFOccupie = True And AITimerSectionF = 0 And AISectionFInUse = True Then
            AISectionFOccupie = False
            AISectionFInUse = False
        End If
    End Sub
    Public Sub AISectionG()
        'Start SectionG code as train arrives in section
        If AISectionGOccupie = True And AITimerSectionG = 0 And AISectionGInUse = False Then
            AITimerSectionG = AIShortSectionValue
            AISectionGInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionGInUse = True Then
            If AISectionGOccupie = True And AITimerSectionG <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ7E) = SignalAtDanger Then
                    AISectionHOccupie = True
                    AITimerSectionG = 0
                End If
            Else
                AITimerSectionG = AITimerSectionG - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionGOccupie = True And AITimerSectionG = 0 And AISectionGInUse = True Then
            AISectionGOccupie = False
            AISectionGInUse = False
        End If
    End Sub
    Public Sub AISectionH()
        'Start SectionH code as train arrives in section
        If AISectionHOccupie = True And AITimerSectionH = 0 And AISectionHInUse = False Then
            AITimerSectionH = AIShortSectionValue
            AISectionHInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionHInUse = True Then
            If AISectionHOccupie = True And AITimerSectionH <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ1E) = SignalAtDanger Then
                    If Points.PointReturns(PointNames.P11) = PointInNormal Then
                        If Points.PointReturns(PointNames.P5a) = PointInNormal Then
                            AISectionAOccupie = True
                            AITimerSectionH = 0
                        ElseIf Points.PointReturns(PointNames.P5a) = PointInReverse Then
                            AISectionKOccupie = True
                            AITimerSectionH = 0
                        Else
                            MsgBox("AI Train in section H derailed on point 5a")
                        End If
                    ElseIf Points.PointReturns(PointNames.P11) = PointInReverse Then
                        AISectionA11Occupie = True
                        AITimerSectionH = 0
                    Else
                        MsgBox("AI Train in section H derailed on point 11")
                    End If
                End If
            Else
                AITimerSectionH = AITimerSectionH - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionHOccupie = True And AITimerSectionH = 0 And AISectionHInUse = True Then
            AISectionHOccupie = False
            AISectionHInUse = False
        End If
    End Sub
    Public Sub AISectionI()
        'Start SectionI code as train arrives in section
        If AISectionIOccupie = True And AITimerSectionI = 0 And AISectionIInUse = False Then
            AITimerSectionI = AIMediumSectionValue
            AISectionIInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionIInUse = True Then
            If AISectionIOccupie = True And AITimerSectionI <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ21E) = SignalAtDanger Then
                    AISectionQ10Occupie = True
                    AITimerSectionI = 0
                    If Not Points.PointReturns(PointNames.P10) = PointInReverse Then MsgBox("AI Train in section Q10 derailed on point 10")
                End If
            Else
                AITimerSectionI = AITimerSectionI - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionIOccupie = True And AITimerSectionI = 0 And AISectionIInUse = True Then
            AISectionIOccupie = False
            AISectionIInUse = False
        End If
    End Sub
    Public Sub AISectionJ()
        'Start SectionJ code as train arrives in section
        If AISectionJOccupie = True And AITimerSectionJ = 0 And AISectionJInUse = False Then
            AITimerSectionJ = AIShortSectionValue
            AISectionJInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionJInUse = True Then
            If AISectionJOccupie = True And AITimerSectionJ <= AIBetweenSections Then
                AISectionBOccupie = True
                AITimerSectionJ = AITimerSectionJ - 1
                If Not Points.PointReturns(PointNames.P6b) = PointInReverse Then MsgBox("AI Train in section J derailed on point 6b")
            Else
                AITimerSectionJ = AITimerSectionJ - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionJOccupie = True And AITimerSectionJ = 0 And AISectionJInUse = True Then
            AISectionJOccupie = False
            AISectionJInUse = False
        End If
    End Sub
    Public Sub AISectionK()
        'Start SectionK code as train arrives in section
        If AISectionKOccupie = True And AITimerSectionK = 0 And AISectionKInUse = False Then
            AITimerSectionK = AIShortSectionValue
            AISectionKInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionKInUse = True Then
            If AISectionKOccupie = True And AITimerSectionK <= AIBetweenSections Then
                AISectionMOccupie = True
                AITimerSectionK = AITimerSectionK - 1
                'If Not Points.PointReturns(Point5a) = PointInReverse Then MsgBox("AI Train in section K derailed on point 5b")
            Else
                AITimerSectionK = AITimerSectionK - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionKOccupie = True And AITimerSectionK = 0 And AISectionKInUse = True Then
            AISectionKOccupie = False
            AISectionKInUse = False
        End If
    End Sub
    Public Sub AISectionL()
        'Start SectionL code as train arrives in section
        If AISectionLOccupie = True And AITimerSectionL = 0 And AISectionLInUse = False Then
            AITimerSectionL = AIShortSectionValue
            AISectionLInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionLInUse = True Then
            If AISectionLOccupie = True And AITimerSectionL <= AIBetweenSections Then
                AISectionMOccupie = True
                AITimerSectionL = AITimerSectionL - 1
                If Not Points.PointReturns(PointNames.P6a) = PointInNormal Then MsgBox("AI Train in section L derailed on point 6b")
            Else
                AITimerSectionL = AITimerSectionL - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionLOccupie = True And AITimerSectionL = 0 And AISectionLInUse = True Then
            AISectionLOccupie = False
            AISectionLInUse = False
        End If
    End Sub
    Public Sub AISectionM()
        'Start SectionM code as train arrives in section
        If AISectionMOccupie = True And AITimerSectionM = 0 And AISectionMInUse = False Then
            AITimerSectionM = AIShortSectionValue
            AISectionMInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionMInUse = True Then
            If AISectionMOccupie = True And AITimerSectionM <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ18E) = SignalAtDanger Then
                    AISectionNOccupie = True
                    AITimerSectionM = 0
                End If
            Else
                AITimerSectionM = AITimerSectionM - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionMOccupie = True And AITimerSectionM = 0 And AISectionMInUse = True Then
            AISectionMOccupie = False
            AISectionMInUse = False
        End If
    End Sub
    Public Sub AISectionN()
        'Start SectionN code as train arrives in section
        If AISectionNOccupie = True And AITimerSectionN = 0 And AISectionNInUse = False Then
            AITimerSectionN = AIShortSectionValue
            AISectionNInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionNInUse = True Then
            If AISectionNOccupie = True And AITimerSectionN <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ9E) = SignalAtDanger Then
                    If Points.PointReturns(PointNames.P14) = PointInNormal Then
                        AISectionNOOccupie = True
                        AITimerSectionN = 0
                    ElseIf Points.PointReturns(PointNames.P14) = PointInReverse Then
                        AISectionNO14Occupie = True
                        AITimerSectionN = AITimerSectionN - 1
                    Else
                        MsgBox("AI Train in section N derailed on point 14")
                    End If
                End If
            Else
                AITimerSectionN = AITimerSectionN - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionNOccupie = True And AITimerSectionN = 0 And AISectionNInUse = True Then
            AISectionNOccupie = False
            AISectionNInUse = False
        End If
    End Sub
    Public Sub AISectionO()
        'Start SectionO code as train arrives in section
        If AISectionOOccupie = True And AITimerSectionO = 0 And AISectionOInUse = False Then
            AITimerSectionO = AIShortSectionValue
            AISectionOInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionOInUse = True Then
            If AISectionOOccupie = True And AITimerSectionO <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ17E) = SignalAtDanger Then
                    AISectionOPOccupie = True
                    AITimerSectionO = 0
                End If
            Else
                AITimerSectionO = AITimerSectionO - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionOOccupie = True And AITimerSectionO = 0 And AISectionOInUse = True Then
            AISectionOOccupie = False
            AISectionOInUse = False
        End If
    End Sub
    Public Sub AISectionP()
        'Start SectionP code as train arrives in section
        If AISectionPOccupie = True And AITimerSectionP = 0 And AISectionPInUse = False Then
            AITimerSectionP = AIShortSectionValue
            AISectionPInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionPInUse = True Then
            If AISectionPOccupie = True And AITimerSectionP <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ2E) = SignalAtDanger Then
                    AISectionQOccupie = True
                    AITimerSectionP = 0
                    If Not Points.PointReturns(PointNames.P10) = PointInNormal Then MsgBox("AI Train in section Q derailed on point 10")
                End If
            Else
                AITimerSectionP = AITimerSectionP - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionPOccupie = True And AITimerSectionP = 0 And AISectionPInUse = True Then
            AISectionPOccupie = False
            AISectionPInUse = False
        End If
    End Sub
    Public Sub AISectionQ()
        'Start SectionQ code as train arrives in section
        If AISectionQOccupie = True And AITimerSectionQ = 0 And AISectionQInUse = False Then
            AITimerSectionQ = AIShortSectionValue
            AISectionQInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionQInUse = True Then
            If AISectionQOccupie = True And AITimerSectionQ <= AIBetweenSections Then
                If Points.PointReturns(PointNames.P6a) = PointInNormal Then
                    AISectionLOccupie = True
                    AITimerSectionQ = AITimerSectionQ - 1
                ElseIf Points.PointReturns(PointNames.P6a) = PointInReverse Then
                    AISectionJOccupie = True
                    AITimerSectionQ = AITimerSectionQ - 1
                Else
                    MsgBox("AI Train in section Q derailed on point 6a")
                End If
            Else
                AITimerSectionQ = AITimerSectionQ - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionQOccupie = True And AITimerSectionQ = 0 And AISectionQInUse = True Then
            AISectionQOccupie = False
            AISectionQInUse = False
        End If
    End Sub
    Public Sub AISectionA11()
        'Start SectionA11 code as train arrives in section
        If AISectionA11Occupie = True And AITimerSectionA11 = 0 And AISectionA11InUse = False Then
            AITimerSectionA11 = AIShortSectionValue
            AISectionA11InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionA11InUse = True Then
            If AISectionA11Occupie = True And AITimerSectionA11 <= AIBetweenSections Then
                AITimerSectionA11 = AITimerSectionA11 - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionA11Occupie = True And AITimerSectionA11 = 0 And AISectionA11InUse = True Then
            AISectionA11Occupie = False
            AISectionA11InUse = False
        End If
    End Sub
    Public Sub AISectionC19()
        'Start SectionC19 code as train arrives in section
        If AISectionC19Occupie = True And AITimerSectionC19 = 0 And AISectionC19InUse = False Then
            AITimerSectionC19 = AIShortSectionValue
            AISectionC19InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionC19InUse = True Then
            If AISectionC19Occupie = True And AITimerSectionC19 <= AIBetweenSections Then
                AITimerSectionC19 = AITimerSectionC19 - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionC19Occupie = True And AITimerSectionC19 = 0 And AISectionC19InUse = True Then
            AISectionC19Occupie = False
            AISectionC19InUse = False
        End If
    End Sub
    Public Sub AISectionDE()
        'Start SectionDE code as train arrives in section
        If AISectionDEOccupie = True And AITimerSectionDE = 0 And AISectionDEInUse = False Then
            AITimerSectionDE = AIShortSectionValue
            AISectionDEInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionDEInUse = True Then
            If AISectionDEOccupie = True And AITimerSectionDE <= AIBetweenSections Then
                If Not SignalOutputState(Definitions.SignalNames.AJ3E) = SignalAtDanger Then
                    AISectionEOccupie = True
                    AITimerSectionDE = 0
                End If
            Else
                AITimerSectionDE = AITimerSectionDE - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionDEOccupie = True And AITimerSectionDE = 0 And AISectionDEInUse = True Then
            AISectionDEOccupie = False
            AISectionDEInUse = False
        End If
    End Sub
    Public Sub AISectionF12()
        'Start SectionF12 code as train arrives in section
        If AISectionF12Occupie = True And AITimerSectionF12 = 0 And AISectionF12InUse = False Then
            AITimerSectionF12 = AIShortSectionValue
            AISectionF12InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionF12InUse = True Then
            If AISectionF12Occupie = True And AITimerSectionF12 <= AIBetweenSections Then
                AISectionGOccupie = True
                If Not Points.PointReturns(PointNames.P12) = PointInReverse Then MsgBox("AI Train in section F12 derailed on point 12")
            End If
            AITimerSectionF12 = AITimerSectionF12 - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionF12Occupie = True And AITimerSectionF12 = 0 And AISectionF12InUse = True Then
            AISectionF12Occupie = False
            AISectionF12InUse = False
        End If
    End Sub
    Public Sub AISectionF13()
        'Start SectionF13 code as train arrives in section
        If AISectionF13Occupie = True And AITimerSectionF13 = 0 And AISectionF13InUse = False Then
            AITimerSectionF13 = AIShortSectionValue
            AISectionF13InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionF13InUse = True Then
            If AISectionF13Occupie = True And AITimerSectionF13 <= AIBetweenSections Then
                AISectionIOccupie = True
            Else
                AITimerSectionF13 = AITimerSectionF13 - 1
            End If
        End If
        'Code to clear section once section timer reaches 0
        If AISectionF13Occupie = True And AITimerSectionF13 = 0 And AISectionF13InUse = True Then
            AISectionF13Occupie = False
            AISectionF13InUse = False
        End If
    End Sub
    Public Sub AISectionNO()
        'Start SectionNO code as train arrives in section
        If AISectionNOOccupie = True And AITimerSectionNO = 0 And AISectionNOInUse = False Then
            AITimerSectionNO = AIShortSectionValue
            AISectionNOInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionNOInUse = True Then
            If AISectionNOOccupie = True And AITimerSectionNO <= AIBetweenSections Then
                AISectionOOccupie = True
            End If
            AITimerSectionNO = AITimerSectionNO - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionNOOccupie = True And AITimerSectionNO = 0 And AISectionNOInUse = True Then
            AISectionNOOccupie = False
            AISectionNOInUse = False
        End If
    End Sub
    Public Sub AISectionNO14()
        'Start SectionNO14 code as train arrives in section
        If AISectionNO14Occupie = True And AITimerSectionNO14 = 0 And AISectionNO14InUse = False Then
            AITimerSectionNO14 = AIShortSectionValue
            AISectionNO14InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionNO14InUse = True Then
            AITimerSectionNO14 = AITimerSectionNO14 - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionNO14Occupie = True And AITimerSectionNO14 = 0 And AISectionNO14InUse = True Then
            AISectionNO14Occupie = False
            AISectionNO14InUse = False
        End If
    End Sub
    Public Sub AISectionOP()
        'Start SectionOP code as train arrives in section
        If AISectionOPOccupie = True And AITimerSectionOP = 0 And AISectionOPInUse = False Then
            AITimerSectionOP = AIShortSectionValue
            AISectionOPInUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionOPInUse = True Then
            If AISectionOPOccupie = True And AITimerSectionOP <= AIBetweenSections Then
                AISectionPOccupie = True
            End If
            AITimerSectionOP = AITimerSectionOP - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionOPOccupie = True And AITimerSectionOP = 0 And AISectionOPInUse = True Then
            AISectionOPOccupie = False
            AISectionOPInUse = False
        End If
    End Sub
    Public Sub AISectionQ10()
        'Start SectionQ10 code as train arrives in section
        If AISectionQ10Occupie = True And AITimerSectionQ10 = 0 And AISectionQ10InUse = False Then
            AITimerSectionQ10 = AIShortSectionValue
            AISectionQ10InUse = True
        End If
        'Code to move into next section once conditions are met
        If AISectionQ10InUse = True Then
            If AISectionQ10Occupie = True And AITimerSectionQ10 <= AIBetweenSections Then
                AISectionQOccupie = True
                If Not Points.PointReturns(PointNames.P10) = PointInReverse Then MsgBox("AI Train in section Q10 derailed on point 10")
            End If
            AITimerSectionQ10 = AITimerSectionQ10 - 1
        End If
        'Code to clear section once section timer reaches 0
        If AISectionQ10Occupie = True And AITimerSectionQ10 = 0 And AISectionQ10InUse = True Then
            AISectionQ10Occupie = False
            AISectionQ10InUse = False
        End If
    End Sub
End Module
```


-------------------------------

Updated on 2022-11-16 at 15:02:29 +0000
